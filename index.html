<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archival Metadata Entry Form</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f9f9f9;
        }

        .container {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 800px;
            box-sizing: border-box;
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 20px;
        }

        form {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            box-sizing: border-box;
        }

        .form-group {
            width: 48%;
            margin-bottom: 20px;
            box-sizing: border-box;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #34495e;
            font-weight: 500;
            font-size: 14px;
        }

        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            box-sizing: border-box;
        }

        textarea {
            resize: vertical;
            height: 100px;
        }

        select {
            appearance: none;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>');
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 16px;
            padding-right: 30px;
        }

        input[type="date"] {
            appearance: none;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>');
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 16px;
            padding-right: 30px;
        }


        input[type="text"]:focus,
        input[type="date"]:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);
        }

        .multi-select-container {
            display: flex;
            flex-direction: column;
        }

        .multi-select {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

        .multi-select input[type="checkbox"] {
            width: 16px;
            height: 16px;
            margin-right: 8px;
        }

        .submit-button {
            width: 100%;
            padding: 12px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 20px;
        }

        .submit-button:hover {
            background-color: #45a049;
        }

        @media (max-width: 768px) {
            .form-group {
                width: 100%;
            }

            .container {
                width: 95%;
                padding: 20px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }

            form {
                flex-direction: column;
            }

            .form-group {
                margin-bottom: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Archival Metadata Entry Form</h1>
        <form id="metadataForm">
            <div class="form-group">
                <label for="fonds">Fonds</label>
                <input type="text" id="fonds" name="fonds" list="fondsOptions" required>
                <datalist id="fondsOptions">
                    <option value="Fonds 1">
                    <option value="Fonds 2">
                    <option value="Fonds 3">
                </datalist>
            </div>
            <div class="form-group">
                <label for="series">Series</label>
                <input type="text" id="series" name="series" list="seriesOptions" required>
                 <datalist id="seriesOptions">
                    <option value="Series A">
                    <option value="Series B">
                    <option value="Series C">
                </datalist>
            </div>
            <div class="form-group">
                <label for="subSeries">Sub-Series</label>
                <input type="text" id="subSeries" name="subSeries" list="subSeriesOptions">
                <datalist id="subSeriesOptions">
                    <option value="Sub-Series 1">
                    <option value="Sub-Series 2">
                    <option value="Sub-Series 3">
                </datalist>
            </div>
            <div class="form-group">
                <label for="collection">Collection</label>
                <input type="text" id="collection" name="collection" list="collectionOptions">
                <datalist id="collectionOptions">
                    <option value="Collection Alpha">
                    <option value="Collection Beta">
                    <option value="Collection Gamma">
                </datalist>
            </div>
            <div class="form-group">
                <label for="location">Location</label>
                <input type="text" id="location" name="location" required>
            </div>
            <div class="form-group">
                <label for="title">Title</label>
                <input type="text" id="title" name="title" required>
            </div>
            <div class="form-group">
                <label for="creator">Creator</label>
                <input type="text" id="creator" name="creator" required>
            </div>
            <div class="form-group">
                <label for="date">Date</label>
                <input type="date" id="date" name="date" required>
            </div>
            <div class="form-group">
                <label for="type">Type</label>
                <select id="type" name="type" required>
                    <option value="" disabled selected>Select Type</option>
                    <option value="Text">Text</option>
                    <option value="Image">Image</option>
                    <option value="Video">Video</option>
                    <option value="Audio">Audio</option>
                </select>
            </div>
            <div class="form-group">
                <label for="format">Format</label>
                <select id="format" name="format" required>
                    <option value="" disabled selected>Select Format</option>
                    <option value="PDF">PDF</option>
                    <option value="JPEG">JPEG</option>
                    <option value="MP4">MP4</option>
                    <option value="MP3">MP3</option>
                </select>
            </div>
            <div class="form-group">
                <label for="description">Description</label>
                <textarea id="description" name="description" required></textarea>
            </div>
            <div class="form-group">
                <label for="subject">Subject/Keywords</label>
                <div class="multi-select-container" id="subjectKeywords">
                    <div class="multi-select">
                        <input type="checkbox" id="subject1" name="subject" value="Keyword 1">
                        <label for="subject1">Keyword 1</label>
                    </div>
                    <div class="multi-select">
                        <input type="checkbox" id="subject2" name="subject" value="Keyword 2">
                        <label for="subject2">Keyword 2</label>
                    </div>
                    <div class="multi-select">
                        <input type="checkbox" id="subject3" name="subject" value="Keyword 3">
                        <label for="subject3">Keyword 3</label>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="language">Language</label>
                <select id="language" name="language" required>
                    <option value="" disabled selected>Select Language</option>
                    <option value="English">English</option>
                    <option value="Spanish">Spanish</option>
                    <option value="French">French</option>
                </select>
            </div>
            <div class="form-group">
                <label for="identifier">Identifier</label>
                <input type="text" id="identifier" name="identifier" readonly>
            </div>
            <div class="form-group">
                <label for="rightsAccess">Rights/Access</label>
                <select id="rightsAccess" name="rightsAccess" required>
                    <option value="" disabled selected>Select Access Level</option>
                    <option value="Public">Public</option>
                    <option value="Private">Private</option>
                    <option value="Copyrighted">Copyrighted</option>
                </select>
            </div>
            <div class="form-group">
                <label for="source">Source</label>
                <input type="text" id="source" name="source" required>
            </div>
            <div class="form-group">
                <label for="publisher">Publisher</label>
                <input type="text" id="publisher" name="publisher" required>
            </div>
             <div class="form-group">
                <label for="contributor">Contributor</label>
                <div class="multi-select-container" id="contributorOptions">
                    <div class="multi-select">
                        <input type="checkbox" id="contributor1" name="contributor" value="Person A">
                        <label for="contributor1">Person A</label>
                    </div>
                    <div class="multi-select">
                        <input type="checkbox" id="contributor2" name="contributor" value="Person B">
                        <label for="contributor2">Person B</label>
                    </div>
                    <div class="multi-select">
                        <input type="checkbox" id="contributor3" name="contributor" value="Person C">
                        <label for="contributor3">Person C</label>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="relation">Relation</label>
                <input type="url" id="relation" name="relation">
            </div>
            <div class="form-group">
                <label for="permanentArchiveLink">Permanent Archive Link</label>
                <input type="url" id="permanentArchiveLink" name="permanentArchiveLink" required>
            </div>
            <div class="form-group">
                <label for="checksum">Checksum</label>
                <input type="text" id="checksum" name="checksum" required>
            </div>
            <div class="form-group">
                <label for="cloudStorageLink">Cloud Storage Link</label>
                <input type="url" id="cloudStorageLink" name="cloudStorageLink">
            </div>
            <div class="form-group">
                <label for="addedBy">Added By</label>
                <input type="text" id="addedBy" name="addedBy" readonly>
            </div>
            <div class="form-group">
                <label for="dateAdded">Date Added</label>
                <input type="text" id="dateAdded" name="dateAdded" readonly>
            </div>
            <div class="form-group">
                <label for="lastModified">Last Modified</label>
                <input type="text" id="lastModified" name="lastModified" readonly>
            </div>
            <button type="submit" class="submit-button" id="saveButton">Save to Google Sheets</button>
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const metadataForm = document.getElementById('metadataForm');
            const identifierInput = document.getElementById('identifier');
            const addedByInput = document.getElementById('addedBy');
            const dateAddedInput = document.getElementById('dateAdded');
            const lastModifiedInput = document.getElementById('lastModified');
            const saveButton = document.getElementById('saveButton');


            function generateUUID() {
                return crypto.randomUUID();
            }

            function getUsername() {
                // This is a placeholder.  For Google Sites, consider:
                // 1.  A separate form to get the user, then pass as a hidden field.
                // 2.  A default value if user identification isn't critical.
                return "GoogleSitesUser";
            }

            identifierInput.value = generateUUID();
            addedByInput.value = getUsername();
            const now = new Date().toISOString();
            dateAddedInput.value = now;
            lastModifiedInput.value = now;

            // --- Google Sites Compatibility ---
            // Use a function to handle the form submission and data sending
            function saveDataToSheet(formData) {
                const scriptUrl = "YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL";  // *** REPLACE THIS LINE ***

                fetch(scriptUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData),
                })
                .then(response => {
                    if (response.ok) {
                        alert('Data saved successfully!');
                        metadataForm.reset();
                        identifierInput.value = generateUUID();
                        addedByInput.value = getUsername();
                        const now = new Date().toISOString();
                        dateAddedInput.value = now;
                        lastModifiedInput.value = now;
                    } else {
                        alert('Failed to save data. Please try again.');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('An error occurred. Please check your connection and try again.');
                });
            }

            metadataForm.addEventListener('submit', function(event) {
                event.preventDefault();

                const formData = new FormData(metadataForm);
                const data = {};

                 formData.forEach((value, key) => {
                    if (key === 'subject' || key === 'contributor') {
                        if (!data[key]) {
                            data[key] = [];
                        }
                        if (value) {
                            data[key].push(value);
                        }
                    } else {
                        data[key] = value;
                    }
                });
                data['lastModified'] = new Date().toISOString();

                // Convert multi-select arrays to comma-separated strings
                if (data.subject) {
                    data.subject = data.subject.join(', ');
                }
                if (data.contributor) {
                    data.contributor = data.contributor.join(', ');
                }
                console.log(data);
                saveDataToSheet(data); // Call the function to save the data
            });
        });
    </script>
</body>
</html>
